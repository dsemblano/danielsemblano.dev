<script type="module">
  import gsap from 'gsap';

  const glow = document.getElementById('cursor-glow');

  if (glow) {
    // Accessibility & perf guards
    const prefersReducedMotion = window.matchMedia(
      '(prefers-reduced-motion: reduce)'
    ).matches;

    const isTouch = window.matchMedia('(pointer: coarse)').matches;

    if (!prefersReducedMotion && !isTouch) {
      // Center glow on cursor
      gsap.set(glow, { xPercent: -50, yPercent: -50 });

      const pos = {
        x: window.innerWidth / 2,
        y: window.innerHeight / 2,
      };

      const mouse = { ...pos };
      const speed = 0.12;

      // Smooth follow
      gsap.ticker.add(() => {
        pos.x += (mouse.x - pos.x) * speed;
        pos.y += (mouse.y - pos.y) * speed;

        gsap.set(glow, {
          x: pos.x,
          y: pos.y,
          force3D: true,
        });
      });

      window.addEventListener('mousemove', (e) => {
        mouse.x = e.clientX;
        mouse.y = e.clientY;
      });
    }
  }
</script>
